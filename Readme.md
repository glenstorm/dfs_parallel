# Описание задачи

Рассмотрим упрощенную задачу процесса сборки. Сборка проекта состоит из таргетов, между которыми могут быть зависимости, которые означают, что до сборки текущего таргета, нужно собрать все его зависимости. Независимые между собой таргеты можно собирать параллельно в мультипоточной среде.

# Описание модели

```cpp
struct Target {
  size_t id;
  std::function<void()> task;
};
```

Структура описывает таргет, у которого есть идентификатор и функтор `task`. Вызов `task()` по своему смыслу выполняет непосредственную сборку таргета, и в процессе сборки должно быть гарантировано, что `task()` будет вызвано только после того, как будут выполнены все `task()` зависимостей. В структуру разрешается **добавлять** поля и методы.

---

```cpp
class BuildGraph;
```

Класс должен описывать структуру сборки проекта, которая является ориентированным графом, вершины которого являются таргеты. Класс необходимо реализовать самостоятельно.

---

```cpp
class Builder {
public:
  explicit Builder(size_t num_threads);

  void execute(const BuildGraph& build_graph, size_t target_id);
};
```

Непосредственно класс, выполняющий сборку проекта. Единственным аргументом конструктора является `num_threads` - имеющееся в распоряжении билдера количество тредов (нитей исполнения), которое можно использовать для сборки. `Builder::execute` принимает на вход структуру сборки проекта и идентификатор таргета, который необходимо собрать. В процессе сборки доступные ресурсы должны утилизироваться максимально.

Если структура сборки некорректна и не может быть выполнена, необходимо бросить исключение (см. пример 2).

Класс необходимо реализовать самостоятельно.

# Пример 1

`graph`: 1 → 2, 2 → 3, 1 → 4, 4 → 5

`target_id`: 1

`num_threads`: 2

Допустим, на сборку каждого таргета уходит 1 секунда. Сначала можно параллельно собирать тагреты 3 и 5, затем 2 и 4, и, наконец, таргет 1.

# Пример 2

`graph`: 1 → 2, 2 → 3, 3 → 4, 4 → 2

`target_id`: 1

`num_threads`: 1

Поскольку в сборке имеется циклическая зависимость: 2 → 3 → 4 → 2, то необходимо бросить исключение.

# Выполнение задания

Необходимо реализовать все описанные выше сущности, при необходимости можно вводить дополнительные. В качестве решения ожидается архив с исходным кодом и скриптом сборки Вашего проекта. Не разрешается использовать никакие дополнительные библиотеки, кроме stdlib.


RUN
run.sh - build and run with test

requiments: ninja-build, cmake (ccache optional)

TESTS
First line - vertex ( targets ) number

Other lines - adjacency list descr of build graph  
